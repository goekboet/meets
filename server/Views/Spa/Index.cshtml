@using Meets.Controllers;
@using System;
@model AppState;

@{
    ViewData["Title"] = "Home Page";
}

@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Xsrf

@functions {
    string user() => Model.Name != null
        ? $"'{Html.Encode(Model.Name)}'"
        : "null";

    string csrf() => $"'{Xsrf.GetAndStoreTokens(Context).RequestToken}'";
}

<script>
    let appstate = 
        { 
            name: @Html.Raw(user()),
            csrf: @Html.Raw(csrf()),
            now: Date.now(),
            focus: initWeekpointer()
        };
    console.log(appstate);
    var app = Elm.Main.init({flags: appstate});
    app.ports.getWeekpointer.subscribe(v => {
        app.ports.gotWeekpointer.send(getWeekpointer(v));
    })
</script>